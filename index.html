<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ä¸€ä»½ç”Ÿæ—¥è´ºå¡</title>
  <style>
    :root {
      --bg: #0a0f1a;
      --grass: #0b1e0b;
      --text: #f0f8ff;
      --accent: #d4a5ff;
      --accent-dark: #a078d0;
    }
    body {
      margin: 0;
      height: 100vh;
      background: linear-gradient(to bottom, var(--grass) 35%, var(--bg) 70%);
      color: var(--text);
      font-family: system-ui, -apple-system, sans-serif;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      position: relative;
    }
    canvas#fireflies {
      position: fixed;
      inset: 0;
      z-index: 1;
      pointer-events: none;
    }
    .main-content {
      position: relative;
      z-index: 10;
      width: 100%;
      max-width: 900px;
      padding: 1rem;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      min-height: 60vh;
      opacity: 0;
      transition: opacity 2.8s ease 6.5s;
    }
    .main-content.visible {
      opacity: 1;
    }
    #stage {
      font-size: clamp(1.5rem, 5vw, 2.5rem);
      line-height: 1.7;
      white-space: pre-wrap;
      opacity: 0;
      transform: translateY(40px);
      transition: all 1.4s ease-out;
    }
    #stage.visible {
      opacity: 1;
      transform: translateY(0);
    }
    .buttons {
      margin-top: 2.5rem;
      display: flex;
      justify-content: center;
      gap: 1.8rem;
      flex-wrap: wrap;
    }
    .btn {
      padding: 0.95rem 2.4rem;
      font-size: 1.22rem;
      color: white;
      background: linear-gradient(135deg, var(--accent), var(--accent-dark));
      border: none;
      border-radius: 999px;
      cursor: pointer;
      box-shadow: 0 7px 22px rgba(160,120,208,0.4);
      transition: all 0.35s;
    }
    .btn:hover {
      transform: translateY(-4px);
      box-shadow: 0 12px 35px rgba(160,120,208,0.65);
    }

    #cake-screen {
      display: none;
      flex-direction: column;
      align-items: center;
    }
    .cake-wrapper {
      position: relative;
      width: 380px;
      height: 380px;
      margin: 2rem auto;
    }
    .cake-img {
      width: 100%;
      height: 100%;
      object-fit: contain;
      filter: drop-shadow(0 15px 30px rgba(0,0,0,0.5));
    }
    .flame {
      position: absolute;
      top: -50px;                 /* â† è¿™é‡Œæ”¹æˆ -95pxï¼ˆæ¯”ä¹‹å‰ -115px ä½ä¸€äº›ï¼‰ï¼Œå¯å†è°ƒæˆ -90px æˆ– -100px */
      left: 50%;
      transform: translateX(-50%);
      width: 0;
      height: 0;
      border-left: 32px solid transparent;
      border-right: 32px solid transparent;
      border-bottom: 110px solid #ff7a7a;
      filter: blur(7px);
      animation: flicker 3s infinite alternate;
      display: none;
      z-index: 3;
      opacity: 0.95;
    }
    .flame-inner {
      position: absolute;
      top: 25px;
      left: -20px;
      width: 40px;
      height: 40px;
      background: #fffb8f;
      border-radius: 50%;
      filter: blur(12px);
    }
    @keyframes flicker {
      0%   { transform: translateX(-50%) scale(1) rotate(5deg); }
      100% { transform: translateX(-50%) scale(1.1) rotate(-5deg); }
    }
    #tip {
      margin-top: 2.5rem;
      font-size: 1.6rem;
      opacity: 0.93;
      color: #e0d4ff;
    }

    #wish-screen {
      display: none;
      flex-direction: column;
      align-items: center;
      padding: 2rem;
    }
    #wish-textarea {
      width: min(90vw, 640px);
      min-height: 140px;
      padding: 1.2rem;
      font-size: 1.25rem;
      background: rgba(255,255,255,0.08);
      border: 1px solid rgba(212,165,255,0.3);
      border-radius: 20px;
      color: white;
      resize: vertical;
      margin: 2rem 0;
      backdrop-filter: blur(10px);
    }
    #wish-textarea::placeholder { color: rgba(240,248,255,0.55); }

    #photo-gallery {
      display: none;
      width: 100%;
      max-width: 900px;
      margin: 2rem auto;
      padding: 1rem;
      flex-direction: column;
      align-items: center;
    }
    #photo-container {
      position: relative;
      width: 100%;
      height: 70vh;
      max-height: 620px;
      overflow: hidden;
      border-radius: 16px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.6);
      background: rgba(0,0,0,0.3);
    }
    #photo-container img {
      width: 100%;
      height: 100%;
      object-fit: contain;
      opacity: 0;
      transition: opacity 1.2s ease;
    }
    #photo-container img.active {
      opacity: 1;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to   { opacity: 1; transform: translateY(0); }
    }
  </style>
</head>
<body>
<canvas id="fireflies"></canvas>

<div class="main-content" id="mainContent">
  <div id="stage"></div>
  <div class="buttons" id="buttons"></div>

  <div id="cake-screen">
    <div class="cake-wrapper">
      <img src="cake.jpg" alt="ç”Ÿæ—¥è›‹ç³•" class="cake-img">
      <div class="flame" id="flame">
        <div class="flame-inner"></div>
      </div>
    </div>
    <div id="tip">ç‚¹èœ¡çƒ›å§ï½</div>
    <button class="btn" id="light-candle" style="margin-top:2.5rem;">ç‚¹äº®èœ¡çƒ›</button>
  </div>

  <div id="wish-screen">
    <h2 style="margin-bottom:1.6rem;">è®¸ä¸ªæ„¿å§ï½</h2>
    <textarea id="wish-textarea" placeholder="æ‚„æ‚„å†™ä¸‹ä½ çš„æ„¿æœ›â€¦â€¦ï¼ˆè¤ç«è™«ä¼šå¸®ä½ ä¿å¯†å“¦ï¼‰"></textarea>
    <button class="btn" id="btn-blow">å¹ç­èœ¡çƒ›</button>
  </div>

  <div id="finish" style="display:none; text-align:center; padding:2rem; max-width:90%;"></div>

  <div id="photo-gallery">
    <div id="photo-container"></div>
    <div style="margin:2rem 0; display:flex; justify-content:center; gap:1.5rem; flex-wrap:wrap;">
      <button class="btn" id="prev-photo">ä¸Šä¸€å¼ </button>
      <button class="btn" id="toggle-play">æš‚åœ</button>
      <button class="btn" id="next-photo">ä¸‹ä¸€å¼ </button>
    </div>
    <button class="btn" id="back-to-finish" style="background:linear-gradient(135deg, #6b7280, #4b5563);">
      è¿”å›ç¥ç¦é¡µ
    </button>
  </div>
</div>

<audio id="bgm" loop preload="auto">
  <source src="birthday-music.mp3" type="audio/mpeg">
</audio>

<audio id="bgm2" loop preload="auto">
  <source src="music2.mp3" type="audio/mpeg">
</audio>

<script>
// ===================== è¤ç«è™« =====================
const canvas = document.getElementById('fireflies');
const ctx = canvas.getContext('2d');
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;
window.addEventListener('resize', () => {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
});

class Firefly {
  constructor(isBackground = false) {
    this.isBackground = isBackground;
    this.reset();
    this.transitionStart = 0;
    this.transitionProgress = 0;
  }

  reset() {
    this.x = Math.random() * canvas.width;
    this.y = canvas.height * (this.isBackground ? 0.15 : 0.6) + Math.random() * canvas.height * (this.isBackground ? 0.7 : 0.4);
    this.size = Math.random() * 2.8 + 1.2;
    this.speed = Math.random() * 0.5 + 0.15;
    this.angle = Math.random() * Math.PI * 2;
    this.hue = 50 + Math.random() * 30;
    this.alpha = Math.random() * 0.4 + 0.15;
    this.phase = Math.random() * Math.PI * 2;
    this.target = null;
    this.transitionStart = 0;
    this.transitionProgress = 0;
  }

  startStarTransition() {
    this.transitionStart = performance.now();
    this.transitionProgress = 0;
  }

  update(targets) {
    const now = performance.now();
    if (this.transitionStart > 0) {
      const elapsed = now - this.transitionStart;
      this.transitionProgress = Math.min(elapsed / 5000, 1);
    }
    const p = this.transitionProgress;

    if (p === 0 && !this.isBackground && targets.length > 0) {
      if (!this.target) this.target = targets[Math.floor(Math.random() * targets.length)];
      const dx = this.target.x - this.x;
      const dy = this.target.y - this.y;
      const dist = Math.hypot(dx, dy);
      if (dist > 1.8) {
        this.x += dx * 0.0035 * this.speed;
        this.y += dy * 0.0035 * this.speed;
      } else {
        this.x += (Math.random() - 0.5) * 0.7;
        this.y += (Math.random() - 0.5) * 0.7;
      }
    } else {
      this.x += Math.cos(this.angle) * this.speed * (0.8 - p * 0.5);
      this.y += Math.sin(this.angle) * this.speed * (0.8 - p * 0.5);
      this.angle += (Math.random() - 0.5) * 0.035;
      if (this.x < 0) this.x += canvas.width;
      if (this.x > canvas.width) this.x -= canvas.width;
      if (this.y < 0) this.y += canvas.height;
      if (this.y > canvas.height) this.y -= canvas.height;
    }

    this.hue = 50 * (1 - p) + (210 + Math.random() * 30) * p;
    this.alpha = 0.3 * (1 - p) + (0.4 + Math.sin(now * 0.0007 + this.phase) * 0.35) * p;
    this.speed = (Math.random() * 0.45 + 0.12) * (1 - p * 0.65);
  }

  draw() {
    ctx.save();
    ctx.globalAlpha = this.alpha;
    const p = this.transitionProgress;
    if (p > 0.1) {
      ctx.fillStyle = `hsl(${this.hue}, 80%, ${82 + Math.sin(Date.now() * 0.0018 + this.phase) * 14}%)`;
      ctx.shadowBlur = 15 + p * 15;
      ctx.shadowColor = '#e0f8ff';
    } else {
      ctx.fillStyle = `hsl(${this.hue}, 100%, ${75 + Math.sin(Date.now() * 0.001 + this.phase) * 10}%)`;
      ctx.shadowBlur = this.isBackground ? 10 : 20;
      ctx.shadowColor = '#c4b5fd';
    }
    ctx.beginPath();
    ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
    ctx.fill();
    ctx.restore();
  }
}

const fireflies = [];
for (let i = 0; i < 220; i++) fireflies.push(new Firefly(false));
for (let i = 0; i < 100; i++) fireflies.push(new Firefly(true));

function getNingPoints() {
  const temp = document.createElement('canvas');
  temp.width = 1100;
  temp.height = 1100;
  const tctx = temp.getContext('2d');
  tctx.font = 'bold 920px sans-serif';
  tctx.textAlign = 'center';
  tctx.textBaseline = 'middle';
  tctx.fillStyle = '#fff';
  tctx.fillText('å®', 550, 550);
  const points = [];
  const data = tctx.getImageData(0, 0, 1100, 1100).data;
  for (let y = 0; y < 1100; y += 3) {
    for (let x = 0; x < 1100; x += 3) {
      if (data[(y * 1100 + x) * 4 + 3] > 60) {
        points.push({
          x: (x / 1100) * canvas.width * 0.72 + canvas.width * 0.14,
          y: (y / 1100) * canvas.height * 0.78 + canvas.height * 0.08
        });
      }
    }
  }
  return points;
}

let ningPoints = [];

function animate() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  if (ningPoints.length === 0) ningPoints = getNingPoints();
  fireflies.forEach(f => {
    f.update(ningPoints);
    f.draw();
  });
  requestAnimationFrame(animate);
}
animate();

// ===================== å¯¹è¯æµç¨‹ =====================
const mainContent = document.getElementById('mainContent');
const stage = document.getElementById('stage');
const btnContainer = document.getElementById('buttons');
const bgm = document.getElementById('bgm');
const bgm2 = document.getElementById('bgm2');

const dialog = [
  { text: "å¾ˆä¹…å¾ˆä¹…ä»¥å‰\næœ‰ä¸€ä½å–„è‰¯ç¾ä¸½çš„å…¬ä¸»è¯´è¦æœ‰éŸ³ä¹ã€‚", buttons: ["æ¥é¦–éŸ³ä¹"], auto: 0 },
  { text: "äºæ˜¯ä¾¿æœ‰äº†éŸ³ä¹", buttons: ["and thanï¼Ÿ"], auto: 0 },
  { text: "thanï¼Ÿ", buttons: ["ä½ ä¸è¯´ç‚¹ä»€ä¹ˆçš„ï¼Ÿ"], auto: 0 },
  { text: "é‚£å°±ï¼Œç¥ä½ ", buttons: [], auto: 1000 },
  { text: "ä»Šåå¹´å¹´ä¸¾æ¯å¤„\näººè‹¥å†°ç‰æ¸…æœ—\nèŠ±ä¼¼é”¦ç»£ç»šçƒ‚", buttons: [], auto: 1000 },
  { text: "ä¿ä¸½è‹¥ä¸‰æ˜¥ä¹‹æ¡ƒ\næ¸…ç´ è‹¥ä¹ç§‹ä¹‹èŠ", buttons: ["è°¢è°¢"], auto: 0 },
  { text: "å®¢ï¼ˆçœŸï¼‰å¥—ï¼ˆå¿ƒï¼‰è¯\nè¯´å®Œäº†\nè¯´è¯´åˆ«çš„å§", buttons: [], auto: 1000 },
  { text: "ä»€ä¹ˆï¼Œå…³äºè¿™ä¸ªç›’å­å•Šï¼Ÿ", buttons: [], auto: 1000 },
  { text: "è¿™ä¸ªç›’å­å°±å¾ˆæœ‰æ•…äº‹äº†", buttons: [], auto: 1000 },
  { text: "æˆ–è®¸åœ¨æŸä¸ªä»°æœ›æ˜Ÿç©ºçš„å¤œé‡Œ\nä½ ä¼šçªç„¶æ„Ÿæ…¨å®‡å®™ä¹‹å¤§", buttons: [], auto: 1000 },
  { text: "è¿˜è®°å¾—é‚£æ¬¡èººåœ¨æ“åœºè‰åœ°\næˆ‘æ€‚æ¿ä½ èººä¸‹æ¥ä»°æœ›æ˜Ÿç©ºå—", buttons: [], auto: 1000},
  { text: "èººä¸‹å»çš„æ—¶å€™æˆ‘åœ¨æƒ³\næ­¤åˆ»åˆ°è¾¾çœ¼çœ¸çš„å…‰\nä¹Ÿè®¸æ˜¯å¾ˆä¹…ä»¥å‰å¯ç¨‹çš„", buttons: [], auto: 1000 },
  { text: "é‚£æ—¶å€™æ—¶é—´è¿˜æ²¡æœ‰æµé€\nç¦»åˆ«ä¹Ÿä»æœªå‘ç”Ÿ", buttons: [], auto: 1000 },
  { text: "ä¸‹ä¸€ç§’\nç°å®çš„å·¨æµªæ‹æ¥\nå‘ç°è‡ªå·±åªèƒ½æ´»åœ¨å½“ä¸‹", buttons: [], auto: 1000 },
  { text: "1å…‰å¹´ = 9.46 ä¸‡äº¿å…¬é‡Œ\nå˜¿å˜¿  è¿™æ˜¯æŸäºº10åˆ†é’Ÿé…é€Ÿ\næ°¸è¿œåˆ°ä¸äº†çš„è·ç¦»", buttons: [], auto: 1000 },
  { text: "æˆ‘ä»¬ç”¨å…‰å¹´ä¸ˆé‡æ˜Ÿæµ·ï¼Œæˆ‘ä»¬ç”¨ä¼ è¯´ç¿»è¯‘æœªçŸ¥", buttons: [], auto: 1000 },
  { text: "æ†§æ†¬ç€å¹¿é˜”ç©ºé—´ï¼Œä¹Ÿä¸è‡ªå·±çš„æ¸ºå°å‘¨æ—‹", buttons: [], auto: 1000 },
  { text: "æ¯•ç«Ÿä½ åˆæ€çŸ¥\nè¤ç«ä¸æ˜¯æ›´è¿œçš„æ˜Ÿæ²³", buttons: [], auto: 1000 },

  { text: "æˆ‘ä»¬èƒ½ä»°æœ›æ˜Ÿç©ºçš„æœºä¼šä¸å¤š\næ¯•ç«Ÿè‰åªæ‰äººï¼ŒèšŠå­å®äºº", buttons: [], auto: 1000 },
  { text: "è¿™ä¸ªç¤¼ç‰©çš„åˆå¿ƒ\nå¸Œæœ›åœ¨ä½ æŠ¬æ‰‹çš„ç‰‡åˆ»", buttons: [], auto: 1000 },
  { text: "ä¾¿èƒ½ä½¿æ˜Ÿæ²³è½»è½»è½è¿›æŒå¿ƒ", buttons: [], auto: 1000 },

  { text: "ä¸è¿‡ä»¥é˜²æŸäºº\næå‰æ‰“å¼€ï¼Œé”™å¤±å¤©æœº", buttons: [], auto: 1000 },
  { text: "åªæœ‰åœ¨çœ‹å®Œè¿™ä»½è´ºå¡æ–¹å¯å¼€å¯", buttons: [], auto: 1000 },

  { text: "æŸäººå–œæ¬¢è¿‡å†œå†ç”Ÿæ—¥\n      ä¹Ÿæœ‰äººè¿‡é˜³å†ç”Ÿæ—¥", buttons: [], auto: 1000 },
  { text: "ç§è®¤ä¸º\né˜´é˜³èåˆï¼Œæ‰æ˜¯å¤©æœº", buttons: ["0207", "0320"], auto: 0 },
  { text: "å¦‚æœè¿˜ä¸æ‡‚ï¼Œå°±å»é—®ä»–", buttons: ["ä»–æ˜¯è°"], auto: 0 },
  { text: "ä¹Œæ¢…â€œå­é…±â€", buttons: ["å¥½æ»´"], auto: 0 },
  { text: "ç”Ÿæ—¥è¿˜å¾—æœ‰è›‹ç³•å§", buttons: ["æ¥äººï¼Œå°†æœ¬å…¬ä¸»çš„è›‹ç³•å‘ˆä¸Š"], auto: 0 },
];

let current = 0;

setTimeout(() => {
  mainContent.classList.add('visible');
  showStep();
}, 6500);

function showStep() {
  if (current >= dialog.length) {
    enterCakeStage();
    return;
  }

  const item = dialog[current];
  stage.classList.remove('visible');

  setTimeout(() => {
    stage.textContent = item.text;
    stage.classList.add('visible');

    btnContainer.innerHTML = '';

    if (item.buttons && item.buttons.length) {
      item.buttons.forEach(txt => {
        const btn = document.createElement('button');
        btn.className = 'btn';
        btn.textContent = txt;
        btn.onclick = () => {
          if (txt === "æ¥é¦–éŸ³ä¹") {
            bgm.play().catch(() => console.log("è‡ªåŠ¨æ’­æ”¾è¢«é˜»æ­¢"));
          }
          current++;
          showStep();
        };
        btnContainer.appendChild(btn);
      });
    }

    if (item.auto > 0) {
      setTimeout(() => {
        current++;
        showStep();
      }, item.auto);
    }
  }, 1400);
}

function enterCakeStage() {
  stage.style.display = 'none';
  btnContainer.style.display = 'none';
  document.getElementById('cake-screen').style.display = 'flex';
}

// ç…§ç‰‡å›é¡¾åŠŸèƒ½
const photos = [
  "1.jpg", "2.jpg", "3.jpg", "4.jpg", "5.jpg",
  "6.jpg", "7.jpg", "8.jpg", "9.jpg", "10.jpg",
  "11.jpg", "12.jpg"
];

let currentPhotoIndex = 0;
let slideshowInterval = null;
const photoContainer = document.getElementById('photo-container');

function showPhoto(index) {
  photoContainer.innerHTML = `
    <img src="${photos[index]}" alt="å›å¿† ${index+1}" class="active">
  `;
}

function startSlideshow() {
  if (slideshowInterval) clearInterval(slideshowInterval);
  slideshowInterval = setInterval(() => {
    currentPhotoIndex = (currentPhotoIndex + 1) % photos.length;
    showPhoto(currentPhotoIndex);
  }, 4000);
}

function stopSlideshow() {
  if (slideshowInterval) {
    clearInterval(slideshowInterval);
    slideshowInterval = null;
  }
}

// ç‚¹äº®èœ¡çƒ›
document.getElementById('light-candle').onclick = () => {
  document.getElementById('flame').style.display = 'block';
  document.getElementById('tip').textContent = 'è®¸æ„¿æ—¶é—´åˆ°ï½';

  setTimeout(() => {
    document.getElementById('cake-screen').style.display = 'none';
    document.getElementById('wish-screen').style.display = 'flex';
  }, 1800);
};

// å¹èœ¡çƒ› â†’ æœ€ç»ˆç¥ç¦
document.getElementById('btn-blow').onclick = () => {
  document.getElementById('wish-screen').style.opacity = '0';
  setTimeout(() => {
    document.getElementById('wish-screen').style.display = 'none';
  }, 800);

  fireflies.forEach(f => f.startStarTransition());

  setTimeout(() => {
    const finish = document.getElementById('finish');
    let html = `
      <h1 style="font-size: clamp(3rem, 9vw, 5.5rem); opacity:0; animation: fadeIn 2s forwards 0.5s;">
        ğŸ‚ ç”Ÿæ—¥å¿«ä¹ğŸ‚
      </h1>
      <h1 style="font-size: clamp(3rem, 9vw, 5.5rem); opacity:0; animation: fadeIn 2s forwards 0.5s;">
        âœ¨å®å°å€©ï¼âœ¨
      </h1>
      <div style="margin:1.8em 0 2.5em; font-size:1.7rem; opacity:0; animation: fadeIn 2s forwards 1.2s;">
        I wish I was a cat  just miaomiaomiao
      </div>
    `;

    const wish = document.getElementById('wish-textarea').value.trim();
    if (wish) {
      html += `
        <div style="opacity:0; animation: fadeIn 2s forwards 2s; max-width:700px; margin:0 auto;">
          <h3>ä½ åˆšåˆšè®¸ä¸‹çš„æ„¿æœ›æ˜¯ï¼š</h3>
          <p style="white-space: pre-wrap; font-size:1.35rem; line-height:1.7;">${wish}</p>
        </div>
        <div style="margin-top:2rem; font-size:1.2rem; opacity:0; animation: fadeIn 2s forwards 2.8s;">
          å¸Œæœ›ä½ å¯»æ‰¾çš„è¤ç«å¾®å…‰ï¼Œç»ˆæˆä¸ºä½ é¢å‰çš„ç’€ç’¨æ˜Ÿæ²³
        </div>
      `;
    } else {
      html += `
        <div style="margin-top:2.5rem; font-size:1.4rem; opacity:0; animation: fadeIn 2s forwards 2s;">
         å¸Œæœ›ä½ å¯»æ‰¾çš„è¤ç«å¾®å…‰ï¼Œç»ˆæˆä¸ºä½ é¢å‰çš„ç’€ç’¨æ˜Ÿæ²³
        </div>
      `;
    }

    html += `
      <button class="btn" id="btn-review" style="margin-top:3.5rem; font-size:1.4rem; padding:1.1rem 3.2rem;">
        å›é¡¾
      </button>
    `;

    finish.innerHTML = html;
    finish.style.display = 'block';

    document.getElementById('btn-review').onclick = () => {
      if (!bgm.paused) bgm.pause();
      bgm2.play().catch(e => console.log("ç¬¬äºŒé¦–æ’­æ”¾è¢«é˜»æ­¢", e));

      finish.style.display = 'none';
      document.getElementById('photo-gallery').style.display = 'flex';
      currentPhotoIndex = 0;
      showPhoto(0);
      startSlideshow();
    };

    document.getElementById('prev-photo').onclick = () => {
      currentPhotoIndex = (currentPhotoIndex - 1 + photos.length) % photos.length;
      showPhoto(currentPhotoIndex);
    };

    document.getElementById('next-photo').onclick = () => {
      currentPhotoIndex = (currentPhotoIndex + 1) % photos.length;
      showPhoto(currentPhotoIndex);
    };

    document.getElementById('toggle-play').onclick = function() {
      if (slideshowInterval) {
        stopSlideshow();
        this.textContent = 'ç»§ç»­æ’­æ”¾';
      } else {
        startSlideshow();
        this.textContent = 'æš‚åœ';
      }
    };

    document.getElementById('back-to-finish').onclick = () => {
      document.getElementById('photo-gallery').style.display = 'none';
      finish.style.display = 'block';
      stopSlideshow();
      document.getElementById('toggle-play').textContent = 'æš‚åœ';

      if (!bgm2.paused) bgm2.pause();
    };

  }, 12000);
};
</script>
</body>
</html>